{
  "format_version": 3,
  "tool": "fpm",
  "version": "1.17.0",
  "platform": {
    "os": "darwin",
    "arch": "amd64"
  },
  "recipe_hash": "71bf52a2a1a356ffb2efca04feb965f543b12051a9ebe46aac039baa488bcc64",
  "deterministic": false,
  "dependencies": [
    {
      "tool": "ruby",
      "version": "4.0.0",
      "recipe_hash": "6d0ac9b358fb401388d532f40e1a23714d4fae56f935b1bc659b1ea6b2c8ab81",
      "dependencies": [
        {
          "tool": "libyaml",
          "version": "0.2.5",
          "recipe_hash": "6924285a8102a97d956d36b71c96a935b4171727fc79f855d3dddb61aaed1eab",
          "dependencies": [
            {
              "tool": "patchelf",
              "version": "0.18.0",
              "recipe_hash": "9758ffc0465a69a5240824812b93b0c2e1e24aa6d09bef8ffc005ba4ed66406d",
              "steps": [
                {
                  "action": "download_file",
                  "params": {
                    "checksum": "730a1f960f0965576c25edf1525ac57c14177ff4ee5fa74d731f6892c0f519ef",
                    "dest": "patchelf.tar.gz",
                    "url": "https://ghcr.io/v2/homebrew/core/patchelf/blobs/sha256:730a1f960f0965576c25edf1525ac57c14177ff4ee5fa74d731f6892c0f519ef"
                  },
                  "evaluable": true,
                  "deterministic": true,
                  "url": "https://ghcr.io/v2/homebrew/core/patchelf/blobs/sha256:730a1f960f0965576c25edf1525ac57c14177ff4ee5fa74d731f6892c0f519ef",
                  "checksum": "730a1f960f0965576c25edf1525ac57c14177ff4ee5fa74d731f6892c0f519ef",
                  "size": 122324
                },
                {
                  "action": "extract",
                  "params": {
                    "archive": "patchelf.tar.gz",
                    "format": "tar.gz",
                    "strip_dirs": 2
                  },
                  "evaluable": true,
                  "deterministic": true
                },
                {
                  "action": "homebrew_relocate",
                  "params": {
                    "formula": "patchelf"
                  },
                  "evaluable": false,
                  "deterministic": true
                },
                {
                  "action": "install_binaries",
                  "params": {
                    "binaries": [
                      "bin/patchelf"
                    ]
                  },
                  "evaluable": true,
                  "deterministic": true
                }
              ],
              "verify": {
                "command": "patchelf --version",
                "pattern": "patchelf {version}"
              }
            }
          ],
          "steps": [
            {
              "action": "download_file",
              "params": {
                "checksum": "4d6e02ce3a82b60033bc7e55bef841dcfef0c05c051176d96accb50744136c6d",
                "dest": "libyaml.tar.gz",
                "url": "https://ghcr.io/v2/homebrew/core/libyaml/blobs/sha256:4d6e02ce3a82b60033bc7e55bef841dcfef0c05c051176d96accb50744136c6d"
              },
              "evaluable": true,
              "deterministic": true,
              "url": "https://ghcr.io/v2/homebrew/core/libyaml/blobs/sha256:4d6e02ce3a82b60033bc7e55bef841dcfef0c05c051176d96accb50744136c6d",
              "checksum": "4d6e02ce3a82b60033bc7e55bef841dcfef0c05c051176d96accb50744136c6d",
              "size": 109164
            },
            {
              "action": "extract",
              "params": {
                "archive": "libyaml.tar.gz",
                "format": "tar.gz",
                "strip_dirs": 2
              },
              "evaluable": true,
              "deterministic": true
            },
            {
              "action": "homebrew_relocate",
              "params": {
                "formula": "libyaml"
              },
              "evaluable": false,
              "deterministic": true
            },
            {
              "action": "install_libraries",
              "params": {
                "patterns": [
                  "lib/*.so*",
                  "lib/*.dylib"
                ]
              },
              "evaluable": true,
              "deterministic": true
            }
          ],
          "recipe_type": "library"
        }
      ],
      "steps": [
        {
          "action": "download_file",
          "params": {
            "checksum": "15109be8090108b5d77d209e9a2e2d90fb60f8f6aa833aa0c42934e24731c237",
            "checksum_algo": "sha256",
            "dest": "ruby-4.0.0-darwin-x64.tar.gz",
            "url": "https://github.com/ruby/ruby-builder/releases/download/ruby-4.0.0/ruby-4.0.0-darwin-x64.tar.gz"
          },
          "evaluable": true,
          "deterministic": true,
          "url": "https://github.com/ruby/ruby-builder/releases/download/ruby-4.0.0/ruby-4.0.0-darwin-x64.tar.gz",
          "checksum": "15109be8090108b5d77d209e9a2e2d90fb60f8f6aa833aa0c42934e24731c237",
          "size": 17930282
        },
        {
          "action": "extract",
          "params": {
            "arch_mapping": {
              "amd64": "x64",
              "arm64": "arm64"
            },
            "archive": "ruby-4.0.0-darwin-x64.tar.gz",
            "format": "tar.gz",
            "os_mapping": {
              "darwin": "darwin",
              "linux": "ubuntu-22.04"
            },
            "strip_dirs": 1
          },
          "evaluable": true,
          "deterministic": true
        },
        {
          "action": "link_dependencies",
          "params": {
            "library": "libyaml"
          },
          "evaluable": true,
          "deterministic": true
        },
        {
          "action": "run_command",
          "params": {
            "command": "mv bin/ruby bin/ruby.real\ncat > bin/ruby << 'WRAPPER'\n#!/bin/bash\n# Resolve symlinks to get the real script location\nSCRIPT_PATH=\"${BASH_SOURCE[0]}\"\nwhile [ -L \"$SCRIPT_PATH\" ]; do\n    SCRIPT_DIR=\"$(cd -P \"$(dirname \"$SCRIPT_PATH\")\" && pwd)\"\n    SCRIPT_PATH=\"$(readlink \"$SCRIPT_PATH\")\"\n    [[ $SCRIPT_PATH != /* ]] && SCRIPT_PATH=\"$SCRIPT_DIR/$SCRIPT_PATH\"\ndone\nSCRIPT_DIR=\"$(cd -P \"$(dirname \"$SCRIPT_PATH\")\" && pwd)\"\nINSTALL_DIR=\"$(dirname \"$SCRIPT_DIR\")\"\n\n# Set library paths for dynamically linked Ruby (includes bundled libyaml)\nif [[ \"$OSTYPE\" == \"darwin\"* ]]; then\n    export DYLD_LIBRARY_PATH=\"$INSTALL_DIR/lib${DYLD_LIBRARY_PATH:+:$DYLD_LIBRARY_PATH}\"\nelse\n    export LD_LIBRARY_PATH=\"$INSTALL_DIR/lib${LD_LIBRARY_PATH:+:$LD_LIBRARY_PATH}\"\nfi\n\n# Dynamically detect Ruby version from lib/ruby directory\nRUBY_VERSION=$(ls -1 \"$INSTALL_DIR/lib/ruby\" 2>/dev/null | grep -E '^[0-9]+\\.[0-9]+\\.[0-9]+$' | head -1)\nif [ -z \"$RUBY_VERSION\" ]; then\n    RUBY_VERSION=$(\"$INSTALL_DIR/bin/ruby.real\" -e 'puts RUBY_VERSION' 2>/dev/null || echo \"3.4.0\")\nfi\n\n# Detect architecture for platform-specific paths\nif [[ \"$OSTYPE\" == \"darwin\"* ]]; then\n    ARCH=$(uname -m)\n    if [ \"$ARCH\" = \"arm64\" ]; then\n        RUBY_ARCH=\"arm64-darwin\"\n    else\n        RUBY_ARCH=\"x86_64-darwin\"\n    fi\n    # Find the exact darwin version directory\n    DARWIN_DIR=$(ls -1 \"$INSTALL_DIR/lib/ruby/$RUBY_VERSION\" 2>/dev/null | grep -E \"darwin\" | head -1)\n    if [ -n \"$DARWIN_DIR\" ]; then\n        RUBY_ARCH=\"$DARWIN_DIR\"\n    fi\nelse\n    ARCH=$(uname -m)\n    case \"$ARCH\" in\n        x86_64) RUBY_ARCH=\"x86_64-linux\" ;;\n        aarch64) RUBY_ARCH=\"aarch64-linux\" ;;\n        *) RUBY_ARCH=\"$ARCH-linux\" ;;\n    esac\nfi\n\n# Set Ruby library paths (override hardcoded paths from build)\nexport RUBYLIB=\"$INSTALL_DIR/lib/ruby/site_ruby/$RUBY_VERSION:$INSTALL_DIR/lib/ruby/site_ruby/$RUBY_VERSION/$RUBY_ARCH:$INSTALL_DIR/lib/ruby/site_ruby:$INSTALL_DIR/lib/ruby/vendor_ruby/$RUBY_VERSION:$INSTALL_DIR/lib/ruby/vendor_ruby/$RUBY_VERSION/$RUBY_ARCH:$INSTALL_DIR/lib/ruby/vendor_ruby:$INSTALL_DIR/lib/ruby/$RUBY_VERSION:$INSTALL_DIR/lib/ruby/$RUBY_VERSION/$RUBY_ARCH${RUBYLIB:+:$RUBYLIB}\"\n\n# Set GEM paths\nexport GEM_HOME=\"$INSTALL_DIR/lib/ruby/gems/$RUBY_VERSION\"\nexport GEM_PATH=\"$GEM_HOME${GEM_PATH:+:$GEM_PATH}\"\n\nexec \"$INSTALL_DIR/bin/ruby.real\" \"$@\"\nWRAPPER\nchmod +x bin/ruby\n\n# Convert Ruby scripts to bash wrappers that call ruby with the script\nfor script in gem irb erb bundle bundler rake rdoc ri; do\n    if [ -f \"bin/$script\" ]; then\n        mv \"bin/$script\" \"bin/$script.rb\"\n        cat > \"bin/$script\" << 'SCRIPTWRAPPER'\n#!/bin/bash\n# Resolve symlinks to get the real script location\nSCRIPT_PATH=\"${BASH_SOURCE[0]}\"\nwhile [ -L \"$SCRIPT_PATH\" ]; do\n    DIR=\"$(cd -P \"$(dirname \"$SCRIPT_PATH\")\" && pwd)\"\n    SCRIPT_PATH=\"$(readlink \"$SCRIPT_PATH\")\"\n    [[ $SCRIPT_PATH != /* ]] && SCRIPT_PATH=\"$DIR/$SCRIPT_PATH\"\ndone\nSCRIPT_DIR=\"$(cd -P \"$(dirname \"$SCRIPT_PATH\")\" && pwd)\"\nSCRIPT_NAME=\"$(basename \"$SCRIPT_PATH\")\"\nexec \"$SCRIPT_DIR/ruby\" \"$SCRIPT_DIR/${SCRIPT_NAME}.rb\" \"$@\"\nSCRIPTWRAPPER\n        chmod +x \"bin/$script\"\n    fi\ndone\n"
          },
          "evaluable": false,
          "deterministic": false
        },
        {
          "action": "install_binaries",
          "params": {
            "binaries": [
              "bin/ruby",
              "bin/gem",
              "bin/bundle",
              "bin/bundler",
              "bin/irb",
              "bin/erb"
            ],
            "install_mode": "directory"
          },
          "evaluable": true,
          "deterministic": true
        }
      ],
      "verify": {
        "command": "{install_dir}/bin/ruby --version",
        "pattern": "ruby {version}"
      }
    }
  ],
  "steps": [
    {
      "action": "gem_exec",
      "params": {
        "executables": [
          "fpm"
        ],
        "gem": "fpm",
        "lock_data": "GEM\n  remote: https://rubygems.org/\n  specs:\n    arr-pm (0.0.12)\n    backports (3.25.3)\n    cabin (0.9.1)\n    clamp (1.3.2)\n    dotenv (2.8.1)\n    fpm (1.17.0)\n      arr-pm (~> 0.0.11)\n      backports (>= 2.6.2)\n      cabin (>= 0.9.1)\n      clamp (>= 1.0.0)\n      pleaserun (~> 0.0.29)\n      rexml\n      stud\n    insist (1.0.0)\n    mustache (0.99.8)\n    pleaserun (0.0.33)\n      cabin (> 0)\n      clamp\n      dotenv (~> 2)\n      insist\n      mustache (= 0.99.8)\n      stud\n    rexml (3.4.4)\n    stud (0.0.23)\n\nPLATFORMS\n  ruby\n  x86_64-linux\n\nDEPENDENCIES\n  fpm (= 1.17.0)\n\nCHECKSUMS\n  arr-pm (0.0.12) sha256=fdff482f75239239201f4d667d93424412639aad0b3b0ad4d827e7c637e0ad39\n  backports (3.25.3) sha256=94298d32dc3c40ca15633b54e282780b49e2db0c045f602ea1907e4f63a17235\n  cabin (0.9.1) sha256=dcc9385af8039ba8fb6e33f0a9036e9e9fedec71c842343ce8e6101776e0322d\n  clamp (1.3.2) sha256=4f6a99a8678d51abbf1650263a74d1ac50939edc11986271431d2e03a0d7a022\n  dotenv (2.8.1) sha256=c5944793349ae03c432e1780a2ca929d60b88c7d14d52d630db0508c3a8a17d8\n  fpm (1.17.0) sha256=a8453a2eefe995294c511282ac36b716e34273647b16450b1477c0796d8db791\n  insist (1.0.0) sha256=6f6759eee583dc4e00a6cc3f713cfa7c570572958ba1f5d65595046d795b832f\n  mustache (0.99.8) sha256=826a96db895819c13fffa4fa3c20b85e80b60aaec1f28f79e7db80092abdb0bc\n  pleaserun (0.0.33) sha256=a61ecd4ac6956dc44a7992ccbd9e4c979d7cd3a25af5ec7cc5b1f17424ffb73f\n  rexml (3.4.4) sha256=19e0a2c3425dfbf2d4fc1189747bdb2f849b6c5e74180401b15734bc97b5d142\n  stud (0.0.23) sha256=6ba26fa28fc50a8d59229b296a733b48d50f1473b1e3e7f5e339d5bbd829eb62\n\nBUNDLED WITH\n  4.0.3\n",
        "ruby_version": "4.0.0",
        "version": "1.17.0"
      },
      "evaluable": false,
      "deterministic": false
    }
  ],
  "verify": {
    "command": "fpm --version",
    "pattern": "{version}"
  }
}
