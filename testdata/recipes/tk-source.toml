# Tk source build from core.tcl-lang.org
# Used for testing fossil_archive with dependency chain
# Tests: fossil_archive + dependencies declaration
#
# NOTE: The Tk Fossil server has bot detection that blocks automated version
# resolution. Install with explicit version: tsuku install tk-source@9.0.3

[metadata]
name = "tk-source"
description = "Graphical toolkit for Tcl (source build for testing)"
homepage = "https://www.tcl.tk/"
dependencies = ["tcl-source"]

[[steps]]
action = "fossil_archive"
repo = "https://core.tcl-lang.org/tk"
project_name = "tk"
tag_prefix = "core-"
version_separator = "-"
strip_dirs = 1

[[steps]]
action = "setup_build_env"

[[steps]]
action = "configure_make"
source_dir = "unix"
executables = ["wish9.0"]

[[steps]]
action = "install_binaries"
install_mode = "directory"
binaries = ["bin/wish9.0"]

[verify]
command = "wish9.0 <<< 'puts $tk_version; exit'"
pattern = "9.0"
