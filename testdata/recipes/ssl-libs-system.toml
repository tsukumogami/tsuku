# Ground truth recipe for OpenSSL development libraries (system dependencies)
# Tests: M30 package manager actions for library packages with different naming conventions
# Demonstrates implicit constraints and platform-specific package naming
#
# NOTE: This recipe will be used by sandbox executor (#770) to test container construction.
# ExtractPackages() will extract package lists, and the sandbox will build containers with them.
# When implementing #770, enhance this recipe to be more complete/realistic for integration testing.

[metadata]
name = "ssl-libs-system"
description = "OpenSSL development libraries from system package managers (test fixture)"
version_format = "semver"

[version]
pin = "1.0.0"

# Debian/Ubuntu: libssl-dev
# Implicit constraint: linux_family = "debian"
[[steps]]
action = "apt_install"
packages = ["libssl-dev"]

# RHEL/Fedora: openssl-devel
# Implicit constraint: linux_family = "rhel"
[[steps]]
action = "dnf_install"
packages = ["openssl-devel"]

# Arch: openssl
# Implicit constraint: linux_family = "arch"
[[steps]]
action = "pacman_install"
packages = ["openssl"]

# Alpine: openssl-dev
# Implicit constraint: linux_family = "alpine"
[[steps]]
action = "apk_install"
packages = ["openssl-dev"]

# openSUSE: libopenssl-devel
# Implicit constraint: linux_family = "suse"
[[steps]]
action = "zypper_install"
packages = ["libopenssl-devel"]

# macOS: OpenSSL via Homebrew
# Implicit constraint: os = "darwin"
[[steps]]
action = "brew_install"
packages = ["openssl@3"]

# Verify openssl command is available
[[steps]]
action = "require_command"
command = "openssl"
version_flag = "version"
version_regex = "OpenSSL ([0-9.]+)"
min_version = "1.1.0"

[verify]
command = "openssl version"
pattern = "OpenSSL"
