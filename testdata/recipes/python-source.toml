# Ground truth recipe for python (source build with patch)
# Used by LLM integration tests (S2)
# Tests: download_file + extract + configure_make with single patch

[metadata]
name = "python-source"
description = "Python programming language (source build for testing)"
homepage = "https://www.python.org/"
dependencies = ["make"]

[version]
source = "homebrew"
formula = "python@3.13"

[[steps]]
action = "download_file"
url = "https://www.python.org/ftp/python/3.13.11/Python-3.13.11.tgz"
dest = "Python-3.13.11.tgz"
checksum = "03cfedbe06ce21bc44ce09245e091a77f2fee9ec9be5c52069048a181300b202"

[[steps]]
action = "extract"
archive = "Python-3.13.11.tgz"
format = "tar.gz"
strip_dirs = 1

[[steps]]
action = "configure_make"
source_dir = "."
executables = ["python3.13"]

# Single patch from Homebrew patches repo
[[patches]]
url = "https://raw.githubusercontent.com/Homebrew/homebrew-core/1cf441a0/Patches/python/3.13-sysconfig.diff"
checksum = "9f2eae1d08720b06ac3d9ef1999c09388b9db39dfb52687fc261ff820bff20c3"
strip = 1

[verify]
command = "python3.13 --version"
pattern = "Python {version}"
