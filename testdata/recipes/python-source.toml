# Ground truth recipe for python (source build with patch)
# Used by LLM integration tests (llm_homebrew_python_single_patch)
# Tests: download + extract + configure_make with single patch

[metadata]
name = "python-source"
description = "Python programming language (source build for testing)"
homepage = "https://www.python.org/"
dependencies = ["make"]

[version]
source = "homebrew"
formula = "python@3.13"

[[steps]]
action = "download"
url = "https://www.python.org/ftp/python/{version}/Python-{version}.tgz"
signature_url = "https://www.python.org/ftp/python/{version}/Python-{version}.tgz.asc"
signature_key_url = "https://keys.openpgp.org/vks/v1/by-fingerprint/7169605F62C751356D054A26A821E680E5FA6305"
signature_key_fingerprint = "7169605F62C751356D054A26A821E680E5FA6305"

[[steps]]
action = "extract"
archive = "Python-{version}.tgz"
format = "tar.gz"
strip_dirs = 1

[[steps]]
action = "configure_make"
source_dir = "."
executables = ["python3.13"]

# Single patch from Homebrew patches repo
[[patches]]
url = "https://raw.githubusercontent.com/Homebrew/homebrew-core/1cf441a0/Patches/python/3.13-sysconfig.diff"
checksum = "9f2eae1d08720b06ac3d9ef1999c09388b9db39dfb52687fc261ff820bff20c3"
strip = 1

[verify]
command = "python3.13 --version"
pattern = "Python {version}"
