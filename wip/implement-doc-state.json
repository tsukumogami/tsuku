{
  "design_doc": "docs/designs/DESIGN-recipe-ci-batching.md",
  "branch": "docs/recipe-ci-batching",
  "pr_number": 1811,
  "integrity_hash": "sha256:5ba5e04120bbea5d5b4a7559b5b2f714e8499d25ce1c149442a27c23c8564401",
  "issues": [
    {
      "number": 1814,
      "title": "ci(test-recipes): batch Linux per-recipe jobs in test-changed-recipes",
      "status": "completed",
      "ci_status": "passed",
      "ci_fix_attempts": 0,
      "issue_type": "code",
      "dependencies": [],
      "commits": [
        "3d0a779ec29d30bee541d645d8d6d47774693c51"
      ],
      "agent_type": "coder",
      "summary": {
        "narrative": "",
        "files_changed": [
          ".github/ci-batch-config.json",
          ".github/workflows/test-changed-recipes.yml"
        ],
        "tests_added": 0,
        "key_decisions": "Mirrored macOS aggregated pattern for Linux inner loop. Used toJson() to pass batch recipes into shell. Used PATH manipulation directly instead of GITHUB_PATH. Kept original recipes/has_changes outputs for macOS path."
      },
      "reviewer_results": [
        {
          "review_focus": "pragmatic",
          "blocking_count": 0,
          "advisory_count": 0
        },
        {
          "review_focus": "architect",
          "blocking_count": 0,
          "advisory_count": 0
        },
        {
          "review_focus": "maintainer",
          "blocking_count": 0,
          "advisory_count": 1
        }
      ],
      "testable_scenarios": [
        "scenario-1",
        "scenario-3",
        "scenario-4",
        "scenario-5",
        "scenario-6",
        "scenario-7",
        "scenario-8",
        "scenario-11",
        "scenario-12"
      ]
    },
    {
      "number": 1815,
      "title": "ci(golden-recipes): batch per-recipe jobs in validate-golden-recipes",
      "status": "completed",
      "ci_status": "passed",
      "ci_fix_attempts": 0,
      "issue_type": "code",
      "dependencies": [
        1814
      ],
      "commits": [
        "4c4288a69817880c927c338452d8eda8268456d5"
      ],
      "agent_type": "coder",
      "summary": {
        "narrative": "",
        "files_changed": [
          ".github/ci-batch-config.json",
          ".github/workflows/validate-golden-recipes.yml"
        ],
        "tests_added": 0,
        "key_decisions": "Removed per-recipe actions/cache entirely rather than switching to batch-level cache keys. Golden validation is CPU-bound so download caching adds no benefit. R2 env vars moved to job-level env block. TSUKU_GOLDEN_SOURCE set per-recipe in inner loop. No ORIG_PATH needed since golden validation does not modify PATH.",
        "requirements_map": [
          {
            "ac": "detect-changes reads batch size from ci-batch-config.json",
            "status": "implemented",
            "evidence": "validate-golden-recipes.yml Split recipes into batches step"
          },
          {
            "ac": "jq ceiling-division pattern for batch splitting",
            "status": "implemented",
            "evidence": "Same pattern as #1814"
          },
          {
            "ac": "New outputs: batches and batch_count",
            "status": "implemented",
            "evidence": "detect-changes outputs"
          },
          {
            "ac": "has_changes output preserved",
            "status": "implemented",
            "evidence": "changed step"
          },
          {
            "ac": "batch_size_override with 1-50 clamping",
            "status": "implemented",
            "evidence": "workflow_dispatch input and clamping logic"
          },
          {
            "ac": "validate-golden job uses batch matrix",
            "status": "implemented",
            "evidence": "matrix.batch fromJson"
          },
          {
            "ac": "Job naming: Validate (batch N/M)",
            "status": "implemented",
            "evidence": "job name template"
          },
          {
            "ac": "Inner loop with ::group:: annotations and failure accumulation",
            "status": "implemented",
            "evidence": "for loop with FAIL_FILE"
          },
          {
            "ac": "r2-health-check preserved",
            "status": "implemented",
            "evidence": "job unchanged"
          },
          {
            "ac": "validate-golden depends on detect-changes and r2-health-check",
            "status": "implemented",
            "evidence": "needs: [detect-changes, r2-health-check]"
          },
          {
            "ac": "validate-golden-recipes entry in ci-batch-config.json with default: 20",
            "status": "implemented",
            "evidence": "ci-batch-config.json"
          }
        ]
      },
      "reviewer_results": [
        {
          "review_focus": "pragmatic",
          "blocking_count": 0,
          "advisory_count": 1
        },
        {
          "review_focus": "architect",
          "blocking_count": 0,
          "advisory_count": 0
        },
        {
          "review_focus": "maintainer",
          "blocking_count": 0,
          "advisory_count": 3
        }
      ],
      "testable_scenarios": [
        "scenario-2",
        "scenario-9",
        "scenario-10",
        "scenario-13"
      ]
    },
    {
      "number": 1816,
      "title": "docs(ci): document batch size configuration and tuning",
      "status": "scrutinized",
      "ci_status": "pending",
      "ci_fix_attempts": 0,
      "issue_type": "code",
      "dependencies": [
        1814,
        1815
      ],
      "commits": [
        "76e653ca00ac7a2455b3217c0542e71810f21242"
      ],
      "agent_type": "coder",
      "summary": {
        "narrative": "",
        "files_changed": [
          "docs/workflow-validation-guide.md",
          "CONTRIBUTING.md"
        ],
        "tests_added": 0,
        "key_decisions": "Added batch configuration section to existing workflow-validation-guide.md. Follow-up for validate-golden-execution.yml documented inline. Batch size verification AC deviated because no CI timing data available in this branch.",
        "requirements_map": [
          {
            "ac": "ci-batch-config.json includes docs explaining batch sizes",
            "status": "implemented",
            "evidence": "workflow-validation-guide.md Configuration File subsection"
          },
          {
            "ac": "Section covering what batch sizes control",
            "status": "implemented",
            "evidence": "workflow-validation-guide.md intro and config file subsections"
          },
          {
            "ac": "How to use batch_size_override",
            "status": "implemented",
            "evidence": "Manual Override via workflow_dispatch subsection"
          },
          {
            "ac": "Guidelines for increasing/decreasing",
            "status": "implemented",
            "evidence": "Tuning Guidelines subsection"
          },
          {
            "ac": "Valid range 1-50",
            "status": "implemented",
            "evidence": "workflow-validation-guide.md lines 186,189"
          },
          {
            "ac": "CONTRIBUTING.md mentions batched jobs",
            "status": "implemented",
            "evidence": "CONTRIBUTING.md paragraph after CI table"
          },
          {
            "ac": "Follow-up note for validate-golden-execution.yml",
            "status": "implemented",
            "evidence": "Follow-Up subsection"
          },
          {
            "ac": "Verify batch sizes produce under 10 min",
            "status": "deviated",
            "evidence": "No CI timing data available; tuning guidelines document when to adjust"
          }
        ]
      },
      "testable_scenarios": [
        "scenario-14"
      ]
    }
  ],
  "skipped_issues": null,
  "test_plan_file": "wip/implement-doc_recipe-ci-batching_test_plan.md"
}
