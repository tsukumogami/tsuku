{
  "design_doc": "docs/designs/DESIGN-llm-testing-strategy.md",
  "branch": "docs/llm-testing-strategy",
  "pr_number": 1752,
  "integrity_hash": "sha256:d80efdc17d7b7c75cb436746472c3f9dd895d2f38292c97c9d18dee36cb28f47",
  "issues": [
    {
      "number": 1753,
      "title": "fix(llm): invalidate dead gRPC connections on server crash",
      "status": "completed",
      "ci_status": "passed",
      "ci_fix_attempts": 0,
      "issue_type": "code",
      "dependencies": [],
      "commits": [
        "008378610c370c727d468f4ccc6282d321a69f32"
      ],
      "agent_type": "coder",
      "summary": {
        "narrative": "",
        "files_changed": [
          "internal/llm/local.go",
          "internal/llm/local_test.go"
        ],
        "tests_added": 2,
        "key_decisions": "Extracted sendRequest method from Complete to isolate gRPC call and connection invalidation logic. Tests call sendRequest directly with bufconn mock, bypassing addon/lifecycle checks."
      },
      "reviewer_results": {
        "issue": 1753,
        "reviewers": [
          {
            "focus": "pragmatic",
            "blocking_count": 0,
            "advisory_count": 0,
            "detail_file": "wip/research/implement-doc_review_pragmatic_issue1753.md"
          },
          {
            "focus": "architect",
            "blocking_count": 0,
            "advisory_count": 0,
            "detail_file": "wip/research/implement-doc_review_architect_issue1753.md"
          },
          {
            "focus": "maintainer",
            "blocking_count": 1,
            "advisory_count": 1,
            "detail_file": "wip/research/implement-doc_review_maintainer_issue1753.md",
            "blocking_resolved": true,
            "resolution_commit": "87bc3361d439640f9b040aa3d9883918f3d7057b"
          }
        ]
      },
      "testable_scenarios": [
        "scenario-1",
        "scenario-2"
      ]
    },
    {
      "number": 1754,
      "title": "test(builders): parameterize ground truth suite for multi-provider support",
      "status": "completed",
      "ci_status": "passed",
      "ci_fix_attempts": 0,
      "issue_type": "code",
      "dependencies": [],
      "commits": [
        "ed14b560"
      ],
      "agent_type": "coder",
      "summary": {
        "narrative": "",
        "files_changed": [
          "internal/builders/llm_integration_test.go",
          "internal/builders/baseline_test.go",
          "testdata/llm-quality-baselines/claude.json"
        ],
        "tests_added": 14,
        "key_decisions": "Extracted compareBaseline as pure function returning baselineDiff struct for testability. Added writeBaselineToDir/loadBaselineFromDir helpers with directory parameter for unit tests. Provider detection: TSUKU_LLM_BINARY \u003e ANTHROPIC_API_KEY \u003e GOOGLE_API_KEY. Factory created via NewFactoryWithProviders with WithPrimaryProvider. claude.json is placeholder with all 21 pass, needs regeneration."
      },
      "reviewer_results": {
        "issue": 1754,
        "reviewers": [
          {
            "focus": "pragmatic",
            "blocking_count": 0,
            "advisory_count": 3,
            "detail_file": "wip/research/implement-doc_review_pragmatic_issue1754.md"
          },
          {
            "focus": "architect",
            "blocking_count": 0,
            "advisory_count": 3,
            "detail_file": "wip/research/implement-doc_review_architect_issue1754.md"
          },
          {
            "focus": "maintainer",
            "blocking_count": 1,
            "advisory_count": 6,
            "detail_file": "wip/research/implement-doc_review_maintainer_issue1754.md",
            "blocking_resolved": true,
            "resolution_commit": "299bd1fd"
          }
        ]
      },
      "testable_scenarios": [
        "scenario-3",
        "scenario-4",
        "scenario-5",
        "scenario-6",
        "scenario-7"
      ]
    },
    {
      "number": 1755,
      "title": "test(builders): create local provider quality baselines",
      "status": "completed",
      "ci_status": "passed",
      "ci_fix_attempts": 0,
      "issue_type": "code",
      "dependencies": [
        1754
      ],
      "commits": [
        "2f8b1511"
      ],
      "agent_type": "coder",
      "summary": {
        "narrative": "",
        "files_changed": [
          "testdata/llm-quality-baselines/local.json"
        ],
        "tests_added": 0,
        "key_decisions": "Created local.json with 21 entries. ast-grep Rust triple marked fail per design doc. Other 20 cases marked pass as placeholders. Needs regeneration on hardware with local model."
      },
      "reviewer_results": {
        "issue": 1755,
        "reviewers": [],
        "note": "Simple tier issue (data file only, no code logic). Skipped full review cycle."
      },
      "testable_scenarios": [
        "scenario-8"
      ]
    },
    {
      "number": 1756,
      "title": "test(llm): add server stability tests",
      "status": "completed",
      "ci_status": "passed",
      "ci_fix_attempts": 0,
      "issue_type": "code",
      "dependencies": [
        1753
      ],
      "commits": [
        "c834c798"
      ],
      "agent_type": "coder",
      "summary": {
        "narrative": "",
        "files_changed": [
          "internal/llm/stability_test.go"
        ],
        "tests_added": 2,
        "key_decisions": "TestSequentialInference uses raw gRPC with 5 distinct prompts. TestCrashRecovery uses NewLocalProvider with t.Setenv for TSUKU_HOME so EnsureRunning restart path is exercised after SIGKILL."
      },
      "reviewer_results": {
        "issue": 1756,
        "reviewers": [
          {
            "focus": "pragmatic",
            "blocking_count": 0,
            "advisory_count": 2,
            "detail_file": "wip/research/implement-doc_review_pragmatic_issue1756.md"
          },
          {
            "focus": "architect",
            "blocking_count": 0,
            "advisory_count": 2,
            "detail_file": "wip/research/implement-doc_review_architect_issue1756.md"
          },
          {
            "focus": "maintainer",
            "blocking_count": 1,
            "advisory_count": 4,
            "detail_file": "wip/research/implement-doc_review_maintainer_issue1756.md",
            "blocking_resolved": true,
            "resolution_commit": "ff8a02001c0b157483d07a36db2a70fccf2943d3"
          }
        ]
      },
      "testable_scenarios": [
        "scenario-9",
        "scenario-10"
      ]
    },
    {
      "number": 1757,
      "title": "ci(llm): add model caching for integration tests",
      "status": "completed",
      "ci_status": "passed",
      "ci_fix_attempts": 0,
      "issue_type": "code",
      "dependencies": [],
      "commits": [
        "b046a876"
      ],
      "agent_type": "coder",
      "summary": {
        "narrative": "",
        "files_changed": [
          ".github/workflows/test.yml",
          "internal/llm/lifecycle_integration_test.go",
          "internal/llm/stability_test.go"
        ],
        "tests_added": 0,
        "key_decisions": "Package-level sync.Once for sharedModelPath. setupTsukuHome creates isolated TempDir with models/ symlink to shared location. actions/cache@v5 for model file keyed by hashFiles(model.rs). Non-inference tests keep using t.TempDir directly."
      },
      "reviewer_results": {
        "issue": 1757,
        "reviewers": [
          {
            "focus": "pragmatic",
            "blocking_count": 1,
            "advisory_count": 1,
            "detail_file": "wip/research/implement-doc_review_pragmatic_issue1757.md",
            "blocking_resolved": true,
            "resolution_commit": "87451b06"
          },
          {
            "focus": "architect",
            "blocking_count": 1,
            "advisory_count": 2,
            "detail_file": "wip/research/implement-doc_review_architect_issue1757.md",
            "blocking_resolved": true,
            "resolution_commit": "87451b06"
          },
          {
            "focus": "maintainer",
            "blocking_count": 2,
            "advisory_count": 2,
            "detail_file": "wip/research/implement-doc_review_maintainer_issue1757.md",
            "blocking_resolved": true,
            "resolution_commit": "87451b06"
          }
        ]
      },
      "testable_scenarios": [
        "scenario-11"
      ]
    },
    {
      "number": 1758,
      "title": "ci(llm): add quality gate for prompt and test matrix changes",
      "status": "completed",
      "ci_status": "passed",
      "ci_fix_attempts": 0,
      "issue_type": "code",
      "dependencies": [
        1754,
        1757
      ],
      "commits": [
        "3abee2a4"
      ],
      "agent_type": "coder",
      "summary": {
        "narrative": "",
        "files_changed": [
          ".github/workflows/test.yml"
        ],
        "tests_added": 0,
        "key_decisions": "llm-quality job mirrors llm-integration structure. Uses HOME not tilde for TSUKU_LLM_MODEL_CACHE. Filter paths: prompts, main.rs, test matrix, baselines. Same model cache key as llm-integration."
      },
      "reviewer_results": {
        "issue": 1758,
        "reviewers": [
          {
            "focus": "pragmatic",
            "blocking_count": 1,
            "advisory_count": 2,
            "detail_file": "wip/research/implement-doc_review_pragmatic_issue1758.md",
            "blocking_resolved": true,
            "resolution_commit": "56cb5639"
          },
          {
            "focus": "architect",
            "blocking_count": 1,
            "advisory_count": 2,
            "detail_file": "wip/research/implement-doc_review_architect_issue1758.md",
            "blocking_resolved": true,
            "resolution_commit": "56cb5639"
          },
          {
            "focus": "maintainer",
            "blocking_count": 1,
            "advisory_count": 4,
            "detail_file": "wip/research/implement-doc_review_maintainer_issue1758.md",
            "blocking_resolved": true,
            "resolution_commit": "56cb5639"
          }
        ]
      },
      "testable_scenarios": [
        "scenario-12",
        "scenario-13"
      ]
    },
    {
      "number": 1759,
      "title": "docs(llm): write manual test runbook",
      "status": "completed",
      "ci_status": "passed",
      "ci_fix_attempts": 0,
      "issue_type": "code",
      "dependencies": [],
      "commits": [
        "adbb9d56"
      ],
      "agent_type": "coder",
      "summary": {
        "narrative": "",
        "files_changed": [
          "docs/llm-testing.md"
        ],
        "tests_added": 0,
        "key_decisions": "Manual test runbook with 3 procedures: full benchmark (10 cases with restarts), soak test (25+ requests monitoring VmRSS), new model validation (ground truth suite comparison). Written for external contributors."
      },
      "reviewer_results": {
        "issue": 1759,
        "reviewers": [],
        "note": "Simple tier issue (documentation only). Skipped full review cycle."
      },
      "testable_scenarios": [
        "scenario-14"
      ]
    }
  ],
  "skipped_issues": null,
  "test_plan_file": null
}
