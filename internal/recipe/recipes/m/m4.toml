[metadata]
name = "m4"
description = "GNU macro processor"
homepage = "https://www.gnu.org/software/m4/"
dependencies = ["make", "zig"]

[version]
source = "homebrew"
formula = "m4"

[[steps]]
action = "homebrew_source"
formula = "m4"

# Fix autotools timestamp issue - source tarballs have timestamps that trigger regeneration
# Touch ALL files to normalize timestamps and prevent autotools from regenerating anything
[[steps]]
action = "run_command"
command = "find . -type f -exec touch {} +"

[[steps]]
action = "configure_make"
source_dir = "."
executables = ["m4"]
configure_args = ["--disable-silent-rules"]

[verify]
command = "m4 --version"
pattern = "m4 (GNU M4) {version}"
