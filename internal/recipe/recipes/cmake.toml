[metadata]
name = "cmake"
description = "Cross-platform build system generator"
homepage = "https://cmake.org/"
dependencies = ["openssl", "patchelf"]
binaries = ["bin/cmake", "bin/ctest", "bin/cpack"]

[[steps]]
action = "homebrew"
formula = "cmake"

[[steps]]
action = "set_rpath"
binaries = ["bin/cmake", "bin/ctest", "bin/cpack", "bin/ccmake"]
rpath = "$ORIGIN/../lib:{libs_dir}/openssl-{deps.openssl.version}/lib"

[[steps]]
action = "install_binaries"
install_mode = "directory"
outputs = ["bin/cmake", "bin/ctest", "bin/cpack", "bin/ccmake"]

[verify]
# Use absolute path to ensure we verify the installed binary, not system cmake
command = "{install_dir}/bin/cmake --version"
pattern = "cmake version {version}"
